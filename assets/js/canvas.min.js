function drawActivity(e,n){var t=new Path.Rectangle({rectangle:{x:e-50,y:n-25,width:100,height:50},strokeWidth:2,strokeColor:"black",fillColor:"white",type:"activity",name:"activity",userName:"",subtype:""}),i=new PointText({fontSize:18,fillColor:"black",justification:"center",name:"elementText",point:[e,n+50]}),o=makeConnectors(e,n,100,50),r=new Group({children:[t,i,o],name:"activtyGroup"}),c=new SymbolDefinition(r),l=new SymbolItem(c,[e,n]);return l.onMouseEnter=function(){this.definition.item.children.connectorGroup.visible=!0},l.onMouseLeave=function(){this.definition.item.children.connectorGroup.visible=!1},l.onMouseDrag=function(e){this.position+=e.delta},l}function insertProps(){var e=document.querySelector(".props-menu"),n=e.querySelector(".prop-input"),t=e.querySelector(".prop-submit");e.classList.add("open"),n.focus();var i=project.activeLayer.lastChild;console.log(i.definition.item.children),t.addEventListener("click",function(){i.definition.item.children.elementText.content=n.value})}function makeConnectors(e,n,t,i){var o=new Path.Circle({radius:4,fillColor:"grey",type:"connector",name:"connector"}),r=[new Point(e+t/2,n),new Point(e,n+i/2),new Point(e-t/2,n),new Point(e,n-i/2)],c=new Group({visible:!1,name:"connectorGroup"}),l=new SymbolDefinition(o);return r.forEach(function(e,n){c.addChild(new SymbolItem(l,e))}),c}function drawEvent(e,n){var t=new Path.Circle({radius:25,center:[e,n],strokeWidth:2,strokeColor:"black",fillColor:"white",type:"event",name:"event",userName:"",subtype:""}),i=new PointText({fontSize:16,fillColor:"black",justification:"center",name:"elementText",point:[e,n+50]}),o=makeConnectors(e,n,50,50),r=new Group({children:[t,i,o],name:"eventGroup"}),c=new SymbolDefinition(r),l=new SymbolItem(c,[e,n]);return l.onMouseEnter=function(){this.definition.item.children.connectorGroup.visible=!0},l.onMouseLeave=function(){this.definition.item.children.connectorGroup.visible=!1},l.onMouseDrag=function(e){this.position+=e.delta},l}function getChildren(e,n){for(var t=[];e;e=e.nextSibling)1==e.nodeType&&e!=n&&t.push(e);return t}function getSiblings(e){return getChildren(e.parentNode.firstChild,e)}var elementType="";tool.minDistance=10,window.addEventListener("wheel",function(e){e.preventDefault(),e.deltaY>0?project.view.zoom-=.02:project.view.zoom+=.02});var eventOptions=document.querySelectorAll(".element-option");eventOptions.forEach(function(e){e.onclick=function(){elementType=this.getAttribute("data-type")}}),project.view.onMouseUp=function(e){"event"===elementType?(drawEvent(e.point.x,e.point.y),insertProps(),elementType=""):"activity"===elementType&&(drawActivity(e.point.x,e.point.y),insertProps(),elementType="")},function(){var e=document.querySelectorAll(".element");e.forEach(function(e){e.addEventListener("click",function(){this.classList.toggle("selected"),getSiblings(this).forEach(function(e){e.classList.remove("selected")})})}),document.querySelector("canvas").addEventListener("click",function(){e.forEach(function(e){e.classList.remove("selected")})})}();